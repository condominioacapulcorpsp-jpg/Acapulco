<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Correspond√™ncia - Condom√≠nio Cozumel</title>
<style>
:root{
  --bg:#2c2f48;
  --nav:#1b2038;
  --active:#1fb954;
  --card:#fff;
  --text-dark:#111;
  --muted:#777;
  --danger:#d9534f;
  --primary:#1B284F;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif;}
body{background:var(--bg);color:#fff;}
.topbar{display:flex;align-items:center;justify-content:space-between;background:var(--nav);padding:12px 18px;color:#fff;flex-wrap:wrap;gap:8px;}
.btn-top,.tab-link{border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-weight:bold;transition:0.2s;}
.btn-top{background:var(--active);color:#000;}
.tab-link{background:transparent;color:#fff;border:1px solid #fff;}
.tab-link:hover,.btn-top:hover{opacity:0.9;}
.container{max-width:700px;margin:20px auto;padding:16px;}
.card{background:var(--card);color:var(--text-dark);border-radius:12px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,0.2);margin-bottom:20px;}
label{display:block;color:var(--muted);margin-top:10px;font-weight:bold;}
input,select,textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:8px;margin-top:6px;font-size:15px;}
button{cursor:pointer;transition:0.2s;}
button:hover{opacity:0.9;}
button.primary{background:var(--primary);color:#fff;padding:10px 14px;border-radius:8px;border:none;font-weight:bold;}
button.small{padding:8px 10px;border-radius:6px;border:none;}
button.danger{background:var(--danger);color:#fff;}
button.muted{background:#777;color:#fff;}
.hidden{display:none;}
.registro-item{display:flex;gap:12px;align-items:flex-start;background:#f9f9f9;border-radius:12px;padding:12px;color:#111;box-shadow:0 2px 6px rgba(0,0,0,0.1);margin-bottom:10px;}
.registro-fotos{display:flex;gap:8px;flex-shrink:0;align-items:center;}
.registro-fotos img{width:60px;height:70px;object-fit:cover;border-radius:8px;border:1px solid #ddd;background:#fff;}
footer{padding:12px;text-align:center;background:var(--nav);color:#fff;margin-top:20px;font-size:14px;}
.assinatura-fullscreen{position:fixed;inset:0;background:#fff;display:none;flex-direction:column;z-index:10000;}
.assinatura-canvas-container{flex:1;display:flex;align-items:center;justify-content:center;padding:10px;}
canvas#assinaturaCanvasFull{background:#fff;touch-action:none;border:1px solid #ccc;border-radius:8px;display:block;max-width:90vw;max-height:70vh;width:100%;height:auto;}
.assinatura-buttons{display:flex;gap:12px;justify-content:center;padding:12px;background:#f0f0f0;}
.assinatura-buttons button{padding:10px 16px;border-radius:8px;border:none;cursor:pointer;font-weight:bold;}
</style>
</head>
<body>
<div class="topbar">
  <button id="tabEnviarBtn" class="btn-top">üí¨ Enviar WhatsApp</button>
  <button id="tabRegistroBtn" class="tab-link">üì∏ Registros</button>
  <button id="tabAdminBtn" class="tab-link">üë§ Admin Contatos</button>
</div>

<div class="container">
  <div id="abaEnviar" class="card">
    <h3>üí¨ Enviar / Registrar Entrega</h3>
    <label>Contato</label>
    <select id="contato"><option value="">-- Selecione --</option></select>
    <label>Empresa</label>
    <input id="registroEmpresa" type="text">
    <label>Observa√ß√£o</label>
    <input id="registroObs" type="text">
    <label>Foto</label>
    <input id="registroFoto" type="file" accept="image/*">
    <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
      <button id="btnSalvarRegistro" class="small primary">üíæ Salvar Registro</button>
      <button id="btnLimparFotoLocal" class="small danger">üßπ Limpar Foto Local</button>
    </div>
  </div>

  <div id="abaRegistro" class="card hidden">
    <h3>üì∏ Registros de Entrega</h3>
    <div id="fotoLocalPreview"></div>
    <div id="assinaturaLocalPreview"></div>
    <button id="btnAssinar" class="small primary">‚úçÔ∏è Assinar</button>
    <button id="btnLimparAssinaturaLocal" class="small danger">üßπ Limpar Assinatura Local</button>
  </div>

  <div id="abaAdmin" class="card hidden">
    <h3>üë§ Gerenciar Contatos</h3>
    <label>Nome</label>
    <input id="novoNome" type="text">
    <label>Apartamento</label>
    <input id="novoApto" type="text">
    <label>Telefone WhatsApp</label>
    <input id="novoTel" type="tel">
    <button id="btnAddMorador" class="primary">‚ûï Adicionar</button>
  </div>
</div>

<div id="assinaturaModal" class="assinatura-fullscreen">
  <div class="assinatura-canvas-container">
    <canvas id="assinaturaCanvasFull"></canvas>
  </div>
  <div class="assinatura-buttons">
    <button id="assinaturaClear" class="danger">üßπ Limpar</button>
    <button id="assinaturaSave" class="primary">üíæ Salvar Local</button>
    <button id="assinaturaClose" class="muted">‚ùå Fechar</button>
  </div>
</div>

<footer>Condom√≠nio Cozumel üå¥</footer>

<script>
// ======== Abas ========
const abaEnviar=document.getElementById('abaEnviar'),
      abaRegistro=document.getElementById('abaRegistro'),
      abaAdmin=document.getElementById('abaAdmin');
document.getElementById('tabEnviarBtn').onclick=()=>{abaEnviar.classList.remove('hidden');abaRegistro.classList.add('hidden');abaAdmin.classList.add('hidden');};
document.getElementById('tabRegistroBtn').onclick=()=>{abaEnviar.classList.add('hidden');abaRegistro.classList.remove('hidden');abaAdmin.classList.add('hidden');};
document.getElementById('tabAdminBtn').onclick=()=>{abaEnviar.classList.add('hidden');abaRegistro.classList.add('hidden');abaAdmin.classList.remove('hidden');};

// ======== Foto local ========
const fotoInput=document.getElementById('registroFoto');
fotoInput.addEventListener('change',()=>{
  const file=fotoInput.files[0];
  if(!file)return;
  const reader=new FileReader();
  reader.onload=()=>{
    localStorage.setItem('fotoLocal',reader.result);
    atualizarPreviewFoto();
  };
  reader.readAsDataURL(file);
});
function atualizarPreviewFoto(){
  const dataURL=localStorage.getItem('fotoLocal');
  const preview=document.getElementById('fotoLocalPreview');
  preview.innerHTML=dataURL?`<img src="${dataURL}" style="width:80px;height:90px;border-radius:8px;border:1px solid #ccc;">`:"<p>Nenhuma foto local.</p>";
}
document.getElementById('btnLimparFotoLocal').onclick=()=>{localStorage.removeItem('fotoLocal');atualizarPreviewFoto();};
window.addEventListener('load',atualizarPreviewFoto);

// ======== Assinatura local ========
const modal=document.getElementById('assinaturaModal');
const canvas=document.getElementById('assinaturaCanvasFull');
const ctx=canvas.getContext('2d');
let desenhando=false;
function resizeCanvas(){
  canvas.width=canvas.clientWidth*2;
  canvas.height=canvas.clientHeight*2;
  ctx.scale(2,2);
  ctx.lineWidth=2;ctx.lineCap='round';
}
resizeCanvas();
window.addEventListener('resize',resizeCanvas);

function desenhar(ev){
  const rect=canvas.getBoundingClientRect();
  const x=(ev.touches?ev.touches[0].clientX:ev.clientX)-rect.left;
  const y=(ev.touches?ev.touches[0].clientY:ev.clientY)-rect.top;
  if(!desenhando)return;
  ctx.lineTo(x,y);
  ctx.stroke();
}
canvas.addEventListener('mousedown',e=>{desenhando=true;ctx.beginPath();ctx.moveTo(e.offsetX,e.offsetY);});
canvas.addEventListener('mousemove',desenhar);
canvas.addEventListener('mouseup',()=>desenhando=false);
canvas.addEventListener('touchstart',e=>{desenhando=true;const t=e.touches[0];ctx.beginPath();ctx.moveTo(t.clientX-canvas.getBoundingClientRect().left,t.clientY-canvas.getBoundingClientRect().top);});
canvas.addEventListener('touchmove',e=>{desenhar(e);e.preventDefault();});
canvas.addEventListener('touchend',()=>desenhando=false);

document.getElementById('assinaturaClear').onclick=()=>ctx.clearRect(0,0,canvas.width,canvas.height);
document.getElementById('assinaturaClose').onclick=()=>modal.style.display='none';
document.getElementById('assinaturaSave').onclick=()=>{
  const dataURL=canvas.toDataURL('image/png');
  localStorage.setItem('assinaturaLocal',dataURL);
  atualizarPreviewAssinatura();
  modal.style.display='none';
};
document.getElementById('btnAssinar').onclick=()=>{modal.style.display='flex';};
document.getElementById('btnLimparAssinaturaLocal').onclick=()=>{localStorage.removeItem('assinaturaLocal');atualizarPreviewAssinatura();};
function atualizarPreviewAssinatura(){
  const dataURL=localStorage.getItem('assinaturaLocal');
  const preview=document.getElementById('assinaturaLocalPreview');
  preview.innerHTML=dataURL?`<img src="${dataURL}" style="width:80px;height:90px;border-radius:8px;border:1px solid #ccc;">`:"<p>Nenhuma assinatura local.</p>";
}
window.addEventListener('load',atualizarPreviewAssinatura);
</script>
</body>
</html>
